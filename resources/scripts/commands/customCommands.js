!function(){function e(e){var s=(Packages.com.gmt2001.HttpResponse,Packages.com.gmt2001.HttpRequest),a=Packages.java.util.HashMap,m=s.getData(s.RequestType.GET,e,"",new a);return m.content}function s(e,s){e=e.toLowerCase(),s=s.toLowerCase(),$.inidb.exists("pricecom",s)&&parseInt($.inidb.get("pricecom",s))>0&&($.isMod(e)||($.inidb.incr("points",e,$.inidb.get("pricecom",s)),$.inidb.SaveAll()))}function a(s,a,m,i,n){var t,P,E,j,I,M,R=Packages.org.json.JSONObject,N="",O="",G="",S="",s=s+"",q=a.getSender(),A=a.getArgs();if(-1!=s.indexOf("(touser)")&&(P=A[0]?A[0]:q),-1!=s.indexOf("(price)")&&(E=null==$.inidb.get("pricecom",m)?0:$.inidb.get("pricecom",m)),-1!=s.indexOf("(count)")&&$.inidb.incr("commandCount",m,1),-1!=s.indexOf("(1)"))for(var L=0;L<A.length;L++)s=s.replace("("+(L+1)+")",A[L]);if(j=s.match(o)){if(-1!=j[1].indexOf("$1"))for(var L=1;9>=L&&-1!=j[1].indexOf("$"+L);L++){if(!A[L-1])return $.lang.get("customcommands.customapi.404",m);j[1]=j[1].replace("$"+L,A[L-1])}G=e(j[1])}if(j=s.match(r)){if(-1!=j[1].indexOf("$1"))for(var L=1;9>=L&&-1!=j[1].indexOf("$"+L);L++){if(!A[L-1])return $.lang.get("customcommands.customapi.404",m);j[1]=j[1].replace("$"+L,A[L-1])}O=e(j[1]),I=j[2].split(" ");for(var T=0;T<I.length;T++)if(I[T].startsWith("{")&&I[T].endsWith("}"))G+=" "+I[T].match(d)[1];else if(I[T].startsWith("{")&&!I[T].endsWith("}")){for(S="";!I[T].endsWith("}");)S+=I[T++]+" ";S+=I[T],G+=" "+S.match(d)[1]}else if(M=I[T].split("."),1==M.length){try{N=new R(O).getString(M[0])}catch(W){if(-1==W.message.indexOf("not a string"))return $.lang.get("customcommands.customapijson.err",m);try{N=t.getInt(M[0])}catch(W){return $.lang.get("customcommands.customapijson.err",m)}}G+=" "+N}else{for(var L=0;L<M.length-1;L++)t=0==L?new R(O).getJSONObject(M[L]):t.getJSONObject(M[L]);try{N=t.getString(M[L])}catch(W){if(-1==W.message.indexOf("not a string"))return $.lang.get("customcommands.customapijson.err",m);try{N=t.getInt(M[L])}catch(W){return $.lang.get("customcommands.customapijson.err",m)}}G+=" "+N}}if(i)for(L in i){var k=new RegExp("/"+i[L].replace(/([\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|])/g,"\\$&")+"/","ig");s=s.replace(k,n[L])}return s.match(c)?s.replace(g,$.username.resolve(a.getSender())).replace(u,$.username.resolve(P)).replace(l,"@"+$.username.resolve(a.getSender())).replace(p,a.getSender()).replace(f,$.username.resolve($.randElement($.users)[0])).replace(C,$.pointNameMultiple).replace(h,$.getStreamUptime($.channelName)).replace(x,$.getGame($.channelName)).replace(w,$.getStatus($.channelName)).replace(v,$.getFollows($.channelName)).replace(b,$.inidb.get("commandCount",m)).replace(y,E).replace(o,G).replace(r,G):s}function m(e,s,a){return $.isAdmin(e)?0:""==a?$.getCommandGroup(s)>=$.getUserGroupId(e)?0:1:$.getSubcommandGroup(s,a)>=$.getUserGroupId(e)?0:2}function i(e){return parseInt($.inidb.exists("pricecom",e)?$.inidb.get("pricecom",e):0)}function n(){var e,s=$.inidb.GetKeyList("command","");for(e in s)$.commandExists(s[e])||$.registerChatCommand("./commands/customCommands.js",s[e],7)}function t(){var e,s,a=$.inidb.GetKeyList("aliases","");for(s in a)$.commandExists(a[s])||(e=$.inidb.get("aliases",a[s]),$.registerChatCommand("./commands/customCommands.js",a[s],$.getCommandGroup(e)))}var o=new RegExp(/\(customapi\s([\w\W:\/\$\=\?\&]+)\)/),r=new RegExp(/\(customapijson ([\w\.:\/\$=\?\&]+)\s([\w\W]+)\)/),d=new RegExp(/{([\w\W]+)}/),c=new RegExp(/\(customapi|\(sender\)|\(touser\)|\(@sender\)|\(baresender\)|\(random\)|\(pointname\)|\(uptime\)|\(game\)|\(status\)|\(follows\)|\(count\)|\(price\)/),g=new RegExp(/\(sender\)/),u=new RegExp(/\(touser\)/),l=new RegExp(/\(@sender\)/),p=new RegExp(/\(baresender\)/),f=new RegExp(/\(random\)/),C=new RegExp(/\(pointname\)/),h=new RegExp(/\(uptime\)/),x=new RegExp(/\(game\)/),w=new RegExp(/\(status\)/),v=new RegExp(/\(follows\)/),b=new RegExp(/\(count\)/),y=new RegExp(/\(price\)/);$.bind("command",function(e){var s=e.getSender().toLowerCase(),m=($.username.resolve(s,e.getTags()),e.getCommand()),i=e.getArgs(),n=e.getArguments(),t=i[0],o=i[1];if(m.equalsIgnoreCase("addcom")){if(!$.isModv3(s,e.getTags()))return void $.say($.whisperPrefix(s)+$.modMsg);if(!t||!o)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.add.usage"));t=i[0].replace("!",""),n=n.substring(n.indexOf(i[0])+i[0].length()+1),$.inidb.set("command",t,n),$.registerChatCommand("./commands/customCommands.js",t),$.logEvent("./commands/customCommands.js",28,s+" added command !"+t+' with the message "'+n+'"'),$.say($.whisperPrefix(s)+$.lang.get("customcommands.add.success",t))}if(m.equalsIgnoreCase("editcom")){if(!$.isModv3(s,e.getTags()))return void $.say($.whisperPrefix(s)+$.modMsg);if(t=i[0].replace("!",""),!t||!o)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.edit.usage"));if(!$.commandExists(t))return void $.say($.whisperPrefix(s)+$.lang.get("cmd.404",t));n=n.substring(n.indexOf(i[0])+i[0].length()+1),$.inidb.set("command",t,n),$.registerChatCommand("./commands/customCommands.js",t),$.logEvent("./commands/customCommands.js",28,s+" edited the command !"+t+' with the message "'+n+'"'),$.say($.whisperPrefix(s)+$.lang.get("customcommands.edit.success",t))}if(m.equalsIgnoreCase("delcom")){if(!$.isModv3(s,e.getTags()))return void $.say($.whisperPrefix(s)+$.modMsg);if(!i[0])return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.delete.usage"));if(t=i[0].replace("!",""),!t)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.delete.usage"));if(!$.inidb.exists("command",t))return void $.say($.whisperPrefix(s)+$.lang.get("cmd.404",t));$.inidb.del("command",t),$.inidb.del("permcom",t),$.unregisterChatCommand("./commands/customCommands.js",t),$.logEvent("./commands/customCommands.js",28,s+" deleted the command !"+t),$.say($.whisperPrefix(s)+$.lang.get("customcommands.delete.success",t))}if(m.equalsIgnoreCase("aliascom")){if(!$.isModv3(s,e.getTags()))return void $.say($.whisperPrefix(s)+$.modMsg);if(!t||!o)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.usage"));if(t=i[0].replace("!",""),o=i[1].replace("!",""),!$.commandExists(t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.error.target404"));if($.inidb.exists("aliases",o))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.error",o));if($.commandExists(o))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.usage"));$.inidb.set("aliases",o,t),$.registerChatCommand("./commands/customCommands.js",o),$.logEvent("customCommands.js",59,s+' added alias "!'+o+'" for "!'+t+'"'),$.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.success",t,o))}if(m.equalsIgnoreCase("delalias")){if(!$.isModv3(s,e.getTags()))return void $.say($.whisperPrefix(s)+$.modMsg);if(!t)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.delete.usage"));if(t=i[0].replace("!",""),!$.inidb.exists("aliases",t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.alias.delete.error.alias.404",t));$.unregisterChatCommand(t),$.inidb.del("aliases",t),$.logEvent("customCommands.js",56,s+" deleted alias !"+t),$.say($.whisperPrefix(s)+$.lang.get("customcommands.delete.success",t))}if(m.equalsIgnoreCase("permcom")){if(!$.isAdmin(s))return void $.say($.whisperPrefix(s)+$.adminMsg);if(!t||!o)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.set.perm.usage"));if(t=i[0].replace("!",""),2==i.length){var r=i[1];if(isNaN(parseInt(r))&&(r=$.getGroupIdByName(r)),!$.commandExists(t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.set.perm.404",t));$.inidb.set("permcom",t,r),$.logEvent("customCommands.js",56,s+" set permission on command !"+t+" to group "+r),$.say($.whisperPrefix(s)+$.lang.get("customcommands.set.perm.success",t,$.getGroupNameById(r))),$.updateCommandGroup(t,r)}var d=i[1],r=i[2];if(isNaN(parseInt(r))&&(r=$.getGroupIdByName(r)),!$.subCommandExists(t,d))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.set.perm.404",t+" "+d));$.inidb.set("permcom",t+" "+d,r),$.logEvent("customCommands.js",56,s+" set permission on sub command !"+t+" "+d+" to group "+r),$.say($.whisperPrefix(s)+$.lang.get("customcommands.set.perm.success",t+" "+d,$.getGroupNameById(r))),$.updateSubcommandGroup(t,d,r)}if(m.equalsIgnoreCase("pricecom")){if(!$.isAdmin(s))return void $.say($.whisperPrefix(s)+$.adminMsg);if(!t||!o)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.set.price.usage"));if(!$.commandExists(t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.set.price.error.404"));if(isNaN(parseInt(o))||parseInt(o)<0)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.set.price.error.invalid"));t=i[0].replace("!",""),$.inidb.set("pricecom",t,o),list=$.inidb.GetKeyList("aliases","");for(c in list)for(c in list)$.inidb.get("aliases",list[c]).equalsIgnoreCase(t)&&$.inidb.set("pricecom",list[c],o);$.logEvent("customCommands.js",56,s+" set price on command !"+t+" to "+o+" "+$.pointNameMultiple),$.say($.whisperPrefix(s)+$.lang.get("customcommands.set.price.success",t,o,$.pointNameMultiple))}if(m.equalsIgnoreCase("listtags")){if(!$.isAdmin(s))return void $.say($.whisperPrefix(s)+$.adminMsg);$.say($.whisperPrefix(s)+"Command tags: (sender), (@sender), (baresender), (random), (uptime), (game), (status), (follows), (count), (touser), (price), (pointname), (customapi) (customjsonapi)")}if(m.equalsIgnoreCase("commands")){var c,g=$.inidb.GetKeyList("command",""),u="";for(c in g)u+="!",u+=g[c],u+=", ";if(0!=u.length)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.cmds",u))}if(m.equalsIgnoreCase("disablecom")){if(!$.isAdmin(s))return void $.say($.whisperPrefix(s)+$.adminMsg);if(!t)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.disable.usage"));if(!$.commandExists(t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.disable.404"));if($.inidb.exists("disabledCommands",t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.disable.err"));$.inidb.set("disabledCommands",t,!0),$.say($.whisperPrefix(s)+$.lang.get("customcommands.disable.success",t)),$.logEvent("customCommands.js",588,s+" disabled command !"+m)}if(m.equalsIgnoreCase("enablecom")){if(!$.isAdmin(s))return void $.say($.whisperPrefix(s)+$.adminMsg);if(!t)return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.enable.usage"));if(!$.commandExists(t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.enable.404"));if(!$.inidb.exists("disabledCommands",t))return void $.say($.whisperPrefix(s)+$.lang.get("customcommands.enable.err"));$.inidb.del("disabledCommands",t),$.say($.whisperPrefix(s)+$.lang.get("customcommands.enable.success",t)),$.logEvent("customCommands.js",616,s+" re-enabled command !"+m)}$.inidb.exists("command",m.toLowerCase())&&(o=$.inidb.get("command",m.toLowerCase()),$.say(a(o,e,m.toLowerCase())))}),$.bind("initReady",function(){$.bot.isModuleEnabled("./commands/customCommands.js")&&(n(),t(),$.registerChatCommand("./commands/customCommands.js","addcom",2),$.registerChatCommand("./commands/customCommands.js","pricecom",2),$.registerChatCommand("./commands/customCommands.js","aliascom",2),$.registerChatCommand("./commands/customCommands.js","delalias",2),$.registerChatCommand("./commands/customCommands.js","delcom",2),$.registerChatCommand("./commands/customCommands.js","editcom",2),$.registerChatCommand("./commands/customCommands.js","permcom",1),$.registerChatCommand("./commands/customCommands.js","listtags",2),$.registerChatCommand("./commands/customCommands.js","commands",7),$.registerChatCommand("./commands/customCommands.js","disablecom",1),$.registerChatCommand("./commands/customCommands.js","enablecom",1))}),$.returnCommandCost=s,$.replaceCommandTags=a,$.permCom=m,$.getCommandPrice=i}();
