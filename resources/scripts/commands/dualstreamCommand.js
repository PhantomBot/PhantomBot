!function(){function e(){a=$.getIniDbString("dualStreamCommand","otherChannels"),n=$.getIniDbBoolean("dualStreamCommand","timerToggle"),m=$.getIniDbNumber("dualStreamCommand","timerInterval"),r=$.getIniDbNumber("dualStreamCommand","reqMessages"),setInterval(function(){n&&"Channel-1 Channel-2"!=a&&$.isOnline($.channelName)&&t>=r&&($.say($.lang.get("dualstreamcommand.link")+$.username.resolve($.channelName)+"/"+a.replace(" ","/")),t=0)},60*m*1e3,"dualStreamTimer")}var a=$.getSetIniDbString("dualStreamCommand","otherChannels","Channel-1 Channel-2"),n=$.getSetIniDbBoolean("dualStreamCommand","timerToggle",!1),m=$.getSetIniDbNumber("dualStreamCommand","timerInterval",20),r=$.getSetIniDbNumber("dualStreamCommand","reqMessages",10),t=0;$.bind("ircChannelMessage",function(){t++}),$.bind("command",function(s){var l,i=s.getSender(),d=s.getCommand(),o=s.getArgs(),g=s.getArguments().trim(),u=g,h=g,C=o[0],c=o[1];if(d.equalsIgnoreCase("multi")){if(!C){if(null!=a)return void $.say($.lang.get("dualstreamcommand.link")+$.username.resolve($.channelName)+a);if($.isModv3(i,s.getTags()))return void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.usage"))}if(C.equalsIgnoreCase("set"))return $.isModv3(i,s.getTags())?c?(u=u.replace(C+" ",""),h=u.replace(C+" ","/"),h=u.replace(" ","/"),l=h,a=u,$.inidb.set("dualStreamCommand","otherChannels",a),$.say($.lang.get("dualstreamcommand.link.set",$.username.resolve($.channelName)+"/"+l)),void $.logEvent("dualstreamCommand.js",48,i+' set the multi link to "'+$.lang.get("dualstreamcommand.link")+$.username.resolve($.channelName)+"/"+l+'"')):void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.set.usage")):void $.say($.whisperPrefix(i)+$.modMsg);if(C.equalsIgnoreCase("clear"))return $.isModv3(i,s.getTags())?(a="Channel-1 Channel-2",n=!1,$.inidb.del("dualStreamCommand","otherChannels"),$.inidb.set("dualStreamCommand","timerToggle",n),$.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.clear")),void $.logEvent("dualstreamCommand.js",64,i+" cleared the multi link")):void $.say($.whisperPrefix(i)+$.modMsg);if(C.equalsIgnoreCase("timer"))return $.isModv3(i,s.getTags())?c?c.equalsIgnoreCase("on")?(n=!0,$.inidb.set("dualStreamCommand","timerToggle",n),$.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timer.enabled")),void $.logEvent("dualstreamCommand.js",85,i+" enabled the multi timer")):c.equalsIgnoreCase("off")?(n=!1,$.inidb.set("dualStreamCommand","timerToggle",n),$.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timer.disabled")),void $.logEvent("dualstreamCommand.js",91,i+" disabled the multi timer")):void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timer.usage")):void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timer.usage")):void $.say($.whisperPrefix(i)+$.modMsg);if(C.equalsIgnoreCase("timerinterval"))return $.isModv3(i,s.getTags())?c?parseInt(c)<5?void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timerinterval.err")):(m=parseInt(c),$.inidb.set("dualStreamCommand","timerInterval",m),$.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timerinterval.set",m)),$.logEvent("dualstreamCommand.js",116,i+" changed the multi timer interval to "+m+" seconds"),void setInterval(function(){n&&"Channel-1 Channel-2"!=a&&$.isOnline($.channelName)&&t>=r&&($.say($.lang.get("dualstreamcommand.link")+$.username.resolve($.channelName)+a),t=0)},60*m*1e3,"dualStreamTimer")):void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.timerinterval.usage")):void $.say($.whisperPrefix(i)+$.modMsg);if(C.equalsIgnoreCase("reqmessage")){if(!$.isModv3(i,s.getTags()))return void $.say($.whisperPrefix(i)+$.modMsg);if(!c)return void $.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.req.usage"));r=parseInt(c),$.inidb.set("dualStreamCommand","reqMessages",r),$.say($.whisperPrefix(i)+$.lang.get("dualstreamcommand.reqmessages.set",r)),$.logEvent("dualstreamCommand.js",116,i+" changed the multi req messages to "+r+" messages")}}d.equalsIgnoreCase("reloadmulti")&&e()}),setInterval(function(){n&&"Channel-1 Channel-2"!=a&&$.isOnline($.channelName)&&t>=r&&($.say($.lang.get("dualstreamcommand.link")+$.username.resolve($.channelName)+"/"+a.replace(" ","/")),t=0)},60*m*1e3,"dualStreamTimer"),$.bind("initReady",function(){$.bot.isModuleEnabled("./commands/dualstreamCommand.js")&&($.registerChatCommand("./commands/dualstreamCommand.js","multi",7),$.registerChatCommand("./commands/dualstreamCommand.js","reloadmulti",1))})}();
