!function(){var e=$.getSetIniDbNumber("settings","hostReward",200),s=$.getSetIniDbString("settings","hostMessage",$.lang.get("hosthandler.host.message")),t=($.getSetIniDbBoolean("settings","hostHistory",!1),216e5),n={},o=!1;$.bind("twitchHostsInitialized",function(){$.bot.isModuleEnabled("./handlers/hostHandler.js")&&($.consoleLn(">> Enabling hosts announcements"),$.logEvent("hostHandler.js",23,"Host announcements enabled"),o=!0)}),$.bind("twitchHosted",function(i){if($.bot.isModuleEnabled("./handlers/hostHandler.js")){var a=$.username.resolve(i.getHoster()),r=$.systemTime(),h=s,g={};if(o){if($.writeToFile(a,"./addons/hostHandler/latestHost.txt",!1),n[a]){if(n[a].hostTime>r)return;n[a].hostTime=r+t}else n[a]={hostTime:r+t};h=h.replace("(name)",a),h=h.replace("(reward)",e.toString()),$.say(h),$.inidb.incr("points",a.toLowerCase(),e),$.getIniDbBoolean("settings","hostHistory",!1)&&(g={host:String(a),time:r,viewers:0},$.inidb.set("hosthistory",a+"_"+r,JSON.stringify(g)))}}}),$.bind("twitchUnhosted",function(e){if($.bot.isModuleEnabled("./handlers/hostHandler.js")){var s=e.getHoster();delete n[s]}}),$.bind("command",function(t){var o,i=t.getSender().toLowerCase(),a=t.getCommand(),r=t.getArgs(),h=parseInt(r[0]),g=[];if(a.equalsIgnoreCase("hostreward")){if(!$.isAdmin(i))return void $.say($.whisperPrefix(i)+$.adminMsg);if(isNaN(h))return void $.say($.whisperPrefix(i)+$.lang.get("hosthandler.set.hostreward.usage",$.pointNameMultiple));$.inidb.set("settings","hostReward",h),e=parseInt(h),$.say($.whisperPrefix(i)+$.lang.get("hosthandler.set.hostreward.success",$.getPointsString(h))),$.logEvent("hostHandler.js",100,i+" changed the host reward to "+h)}if(a.equalsIgnoreCase("hostmessage")){if(!r||0==r.length)return void $.say($.whisperPrefix(i)+$.lang.get("hosthandler.set.hostmessage.usage"));s=t.getArguments(),$.inidb.set("settings","hostMessage",s),$.say($.whisperPrefix(i)+$.lang.get("hosthandler.set.hostmessage.success")),$.logEvent("hostHandler.js",115,i+" changed the host message to "+s)}if(a.equalsIgnoreCase("unhost")){if(!$.isAdmin(i))return void $.say($.whisperPrefix(i)+$.adminMsg);$.say(".unhost")}if(a.equalsIgnoreCase("host")){if(!$.isAdmin(i))return void $.say($.whisperPrefix(i)+$.adminMsg);$.say(".host "+r[0]),$.logEvent("hostHandler.js",140,i+" hosted channel "+r[1])}if(a.equalsIgnoreCase("hostcount")){for(o in n)g.push(o);if(0==g.length)return void $.say($.lang.get("hosthandler.hostcount.404"));$.say($.lang.get("hosthandler.hostcount",g.length))}if(a.equalsIgnoreCase("hostlist")){for(o in n)g.push(o);if(0==g.length)return void $.say($.lang.get("hosthandler.hostlist.404"));$.say($.lang.get("hosthandler.hostlist",g.join(", ")))}if(a.equalsIgnoreCase("hosthistory")){if(!r||0==r.length)return void $.say($.whisperPrefix(i)+$.lang.get("hosthistory.usage",$.getIniDbBoolean("settings","hostHistory")?"on":"off"));if(r[0].equalsIgnoreCase("on"))$.setIniDbBoolean("settings","hostHistory",!0),$.say($.whisperPrefix(i)+$.lang.get("hosthistory.change",$.getIniDbBoolean("settings","hostHistory")?"on":"off"));else{if(!r[0].equalsIgnoreCase("off"))return void $.say($.whisperPrefix(i)+$.lang.get("hosthistory.usage",$.getIniDbBoolean("settings","hostHistory")?"on":"off"));$.setIniDbBoolean("settings","hostHistory",!1),$.say($.whisperPrefix(i)+$.lang.get("hosthistory.change",$.getIniDbBoolean("settings","hostHistory")?"on":"off"))}}}),$.bind("initReady",function(){$.bot.isModuleEnabled("./handlers/hostHandler.js")&&($.registerChatCommand("./handlers/hostHandler.js","hostmessage",1),$.registerChatCommand("./handlers/hostHandler.js","hostreward",1),$.registerChatCommand("./handlers/hostHandler.js","unhost",1),$.registerChatCommand("./handlers/hostHandler.js","host",1),$.registerChatCommand("./handlers/hostHandler.js","hostcount"),$.registerChatCommand("./handlers/hostHandler.js","hostlist"),$.registerChatCommand("./handlers/hostHandler.js","hosthistory",1))})}();
