!function(){function t(t,n,o,r){if(i.status)return void $.say($.whisperPrefix(t)+$.lang.get("auctionsystem.err.opened"));if(!n||!o)return void $.say($.whisperPrefix(t)+$.lang.get("auctionsystem.usage"));if(n&&(i.increments=parseInt(n)),o&&(i.minimum=parseInt(o)),r&&(i.timer=parseInt(r)),i.status=!0,$.say($.lang.get("auctionsystem.opened",$.getPointsString(n),$.getPointsString(o))),r>0){$.say($.lang.get("auctionsystem.auto.timer.msg",r));var a=setInterval(function(){s(!0),clearInterval(a)},r/2*1e3),g=setInterval(function(){e(),clearInterval(g)},1e3*r)}}function e(t){return i.status?i.topUser?(i.status=!1,$.inidb.decr("points",i.topUser,i.topPoints),void $.say($.lang.get("auctionsystem.closed",i.topUser,$.getPointsString(i.topPoints)))):(i.status=!1,void $.say($.lang.get("auctionsystem.err.no.bids"))):void $.say($.whisperPrefix(t)+$.lang.get("auctionsystem.err.closed"))}function s(t){return i.status?void(t?$.say($.lang.get("auctionsystem.warn.force",i.topUser,$.getPointsString(i.topPoints),$.getPointsString(i.topPoints+i.increments))):$.say($.lang.get("auctionsystem.warn",i.topUser,$.getPointsString(i.topPoints)))):void $.say($.whisperPrefix(user)+$.lang.get("auctionsystem.err.closed"))}function n(t,e){return i.status?e?e<i.minimum?void $.say($.lang.get("auctionsystem.err.bid.minimum",$.getPointsString(i.topPoints))):e>$.getUserPoints(t)?void $.say($.whisperPrefix(t)+$.lang.get("auctionsystem.err.points",$.pointNameMultiple)):e<i.topPoints+i.increments?void $.say($.lang.get("auctionsystem.err.increments",$.getPointsString(i.increments))):(i.topUser=t,i.topPoints=parseInt(e),$.inidb.set("auctionresults","winner",i.topUser),$.inidb.set("auctionresults","amount",i.topPoints),void $.say($.lang.get("auctionsystem.bid",t,$.getPointsString(e),$.getPointsString(i.topPoints+i.increments)))):void $.say($.whisperPrefix(t)+$.lang.get("auctionsystem.bid.usage")):void $.say($.whisperPrefix(t)+$.lang.get("auctionsystem.err.closed"))}var i={increments:0,minimum:0,topUser:0,topPoints:0,timer:0,status:!1};$.bind("command",function(i){var o=i.getSender(),r=i.getCommand(),a=i.getArgs(),g=a[0];if(r.equalsIgnoreCase("auction")){if(!$.isModv3(o,i.getTags()))return void $.say($.getWhisperString(o)+$.modMsg);if(!g)return void $.say($.whisperPrefix(o)+$.lang.get("auctionsystem.usage"));g.equalsIgnoreCase("open")&&t(o,a[1],a[2],a[3]),g.equalsIgnoreCase("close")&&e(o),g.equalsIgnoreCase("warn")&&s()}r.equalsIgnoreCase("bid")&&n(o,g)}),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/auctionSystem.js")&&($.registerChatCommand("./systems/auctionSystem.js","auction",2),$.registerChatCommand("./systems/auctionSystem.js","bid",7))})}();
