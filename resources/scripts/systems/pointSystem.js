!function(){function e(e){return $.inidb.exists("points",e)?parseInt($.inidb.get("points",e)):0}function t(e){return 1==parseInt(e)?e+" "+l:e+" "+m}function i(e){e&&$.commandExists(e.toLowerCase())&&$.unregisterChatCommand(e.toLowerCase()),$.commandExists(l.toLowerCase())||e||($.registerChatCommand("./core/pointSystem.js",$.pointNameSingle.toLowerCase(),7),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"add",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"take",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"set",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"all",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"setname",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"setgain",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"setofflinegain",1),$.registerChatSubcommand($.pointNameSingle.toLowerCase(),"setinterval",1)),$.commandExists(m.toLowerCase())||e||($.registerChatCommand("./core/pointSystem.js",$.pointNameMultiple.toLowerCase(),7),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"add",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"take",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"set",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"all",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"setname",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"setgain",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"setofflinegain",1),$.registerChatSubcommand($.pointNameMultiple.toLowerCase(),"setinterval",1))}function n(){var e,t,i,n=$.systemTime(),g=[];if($.bot.isModuleEnabled("./systems/pointSystem.js")){if($.isOnline($.channelName)){if(!(o>0&&n>=p+6e4*o))return;t=s}else{if(!(r>0&&n>=p+6e4*r))return;t=a}for(i in $.users)e=$.users[i][0].toLowerCase(),$.isOnline($.channelName)?$.inidb.exists("grouppoints",$.getUserGroupId(e))&&(t=parseInt($.inidb.get("grouppoints",$.getUserGroupId(e)))<0?s:parseInt($.inidb.get("grouppoints",$.getUserGroupId(e)))):$.inidb.exists("grouppointsoffline",$.getUserGroupId(e))&&(t=parseInt($.inidb.get("grouppointsoffline",$.getUserGroupId(e)))<0?a:parseInt($.inidb.get("grouppointsoffline",$.getUserGroupId(e)))),$.inidb.incr("points",e,t),g.push(e);$.log("pointSystem","Executed "+$.pointNameMultiple+" payouts. Users: "+(g.length>0?g.join(", "):"none")),p=n}}var s=($.getIniDbBoolean("pointSettings","pointsTimedGain")?$.getIniDbBoolean("pointSettings","pointsTimedGain"):!0,$.inidb.exists("pointSettings","onlineGain")?parseInt($.inidb.get("pointSettings","onlineGain")):1),a=$.inidb.exists("pointSettings","offlineGain")?parseInt($.inidb.get("pointSettings","offlineGain")):1,o=$.inidb.exists("pointSettings","onlinePayoutInterval")?parseInt($.inidb.get("pointSettings","onlinePayoutInterval")):10,r=$.inidb.exists("pointSettings","offlinePayoutInterval")?parseInt($.inidb.get("pointSettings","offlinePayoutInterval")):0,g=$.getIniDbBoolean("pointSettings","modPointsPermToggle")?$.getIniDbBoolean("pointSettings","modPointsPermToggle"):!1,p=0,l=$.inidb.exists("pointSettings","pointNameSingle")?$.inidb.get("pointSettings","pointNameSingle"):"Point",m=$.inidb.exists("pointSettings","pointNameMultiple")?$.inidb.get("pointSettings","pointNameMultiple"):"Points";$.bind("command",function(n){var p,l,m=n.getSender().toLowerCase(),u=$.username.resolve(m,n.getTags()),d=n.getCommand(),f=n.getArgs(),y=f[0],S=f[1],c=f[2];if(d.equalsIgnoreCase("points")||d.equalsIgnoreCase($.pointNameMultiple)||d.equalsIgnoreCase($.pointNameSingle))if(y){if(y.equalsIgnoreCase("add")){if(S=(S+"").toLowerCase(),c=parseInt(c),isNaN(c))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.add.usage"));if(!S||!$.user.isKnown(S))return void $.say($.whisperPrefix(m)+$.lang.get("common.user.404",S));if(0>c)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.add.error.negative",$.pointNameMultiple));$.user.isKnown(S)&&($.inidb.incr("points",S,c),$.say($.lang.get("pointsystem.add.success",$.getPointsString(c),$.username.resolve(S),$.getPointsString($.getUserPoints(S)))))}if(y.equalsIgnoreCase("take")){if(S=(S+"").toLowerCase(),c=parseInt(c),isNaN(c))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.take.usage"));if(!S||!$.user.isKnown(S))return void $.say($.whisperPrefix(m)+$.lang.get("common.user.404",S));if(c>$.getUserPoints(S))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.take.error.toomuch",u,$.pointNameMultiple));$.inidb.decr("points",S,c),$.say($.lang.get("pointsystem.take.success",$.getPointsString(c),$.username.resolve(S),$.getPointsString($.getUserPoints(S))))}if(y.equalsIgnoreCase("set")){if(S=(S+"").toLowerCase(),c=parseInt(c),isNaN(c))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.setbalance.usage"));if(!S||!$.user.isKnown(S))return void $.say($.whisperPrefix(m)+$.lang.get("common.user.404",S));if(0>c)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.setbalance.error.negative",$.pointNameMultiple));$.inidb.set("points",S,c),$.say($.lang.get("pointsystem.setbalance.success",$.pointNameSingle,$.username.resolve(S),$.getPointsString($.getUserPoints(S))))}if(y.equalsIgnoreCase("all")){if(!S)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.add.all.usage"));if(S=parseInt(S),0>S)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.add.error.negative",$.pointNameMultiple));for(l in $.users)$.inidb.incr("points",$.users[l][0].toLowerCase(),S);$.say($.lang.get("pointsystem.add.all.success",$.getPointsString(S)))}if(y.equalsIgnoreCase("setname")){if("single"==S&&c)return p=$.pointNameSingle,$.pointNameSingle=c,$.inidb.set("pointSettings","pointNameSingle",$.pointNameSingle),i(p),i(),void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.name.single.success",p,$.pointNameSingle));if("multiple"==S&&c)return p=$.pointNameMultiple,$.pointNameMultiple=c,$.inidb.set("pointSettings","pointNameMultiple",$.pointNameMultiple),i(p),i(),void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.name.multiple.success",p,$.pointNameMultiple));if(!c)return p=$.pointNameMultiple,$.pointNameMultiple=$.pointNameSingle=c,$.inidb.set("pointSettings","pointNameSingle",$.pointNameSingle),$.inidb.set("pointSettings","pointNameMultiple",$.pointNameSingle),i(p),void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.name.both.success",p,$.pointNameMultiple));$.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.name.usage"))}if(y.equalsIgnoreCase("setgain")){if(S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.gain.usage"));if(0>S)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.gain.error.negative",$.pointNameMultiple));s=S,$.inidb.set("pointSettings","onlineGain",s),$.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.gain.success",$.pointNameSingle,$.getPointsString(s),o))}if(y.equalsIgnoreCase("setofflinegain")){if(S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.gain.offline.usage"));if(0>S)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.gain.error.negative",$.pointNameMultiple));a=S,$.inidb.set("pointSettings","offlineGain",a),$.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.gain.offline.success",$.pointNameSingle,$.getPointsString(a),r))}if(y.equalsIgnoreCase("setinterval")){if(S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.interval.usage"));if(0>S)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.interval.error.negative",$.pointNameMultiple));o=S,$.inidb.set("pointSettings","onlinePayoutInterval",o),$.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.interval.success",$.pointNameSingle,o))}if(y.equalsIgnoreCase("setofflineinterval")){if(S=parseInt(S),isNaN(S))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.interval.offline.usage"));if(0>S)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.interval.error.negative",$.pointNameMultiple));r=S,$.inidb.set("pointSettings","offlinePayoutInterval",r),$.say($.whisperPrefix(m)+$.lang.get("pointsystem.set.interval.offline.success",$.pointNameSingle,r))}y.equalsIgnoreCase("modpermtoggle")&&(g=!g,$.setIniDbBoolean("pointSettings","modPointsPermToggle",g),$.say($.whisperPrefix(m)+$.lang.get("pointsystem.modpermtoggle.success",g?"moderator":"administrator")))}else 0==$.getUserPoints(m)?$.say($.whisperPrefix(m)+$.lang.get("pointsystem.get.self.nopoints",$.pointNameMultiple)):$.say($.whisperPrefix(m)+$.lang.get("pointsystem.get.self.withtime",$.resolveRank(m),$.getPointsString($.getUserPoints(m)),$.getUserTimeString(m)));if(d.equalsIgnoreCase("makeitrain")){if(!$.isAdmin(m))return void $.say($.whisperPrefix(m)+$.adminMsg);if(y=parseInt(y),isNaN(y))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.makeitrain.usage"));if(1>y)return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.makeitrain.error.negative",$.pointNameMultiple));for(l in $.users){var C=$.randRange(1,y);p=[],$.inidb.incr("points",$.users[l][0].toLowerCase(),C),$.users[l][0].equalsIgnoreCase($.botName)||p.push($.username.resolve($.users[l][0])+": "+$.getPointsString(C))}p.length>0&&$.say($.lang.get("pointsystem.makeitrain.success",u,$.pointNameMultiple,p.join(", ")))}if(d.equalsIgnoreCase("gift")){if(!f[0]||!f[1])return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.gift.usage"));if(parseInt(f[1])>e(m))return void $.say($.whisperPrefix(m)+$.lang.get("pointsystem.err.not.points"));$.inidb.incr("points",f[0].toLowerCase(),parseInt(f[1])),$.inidb.decr("points",m,parseInt(f[1])),$.say($.lang.get("pointsystem.gifted",$.username.resolve(m),t(parseInt(f[1])),$.username.resolve(f[0])))}}),setInterval(function(){n()},6e4),$.bind("initReady",function(){$.bot.isModuleEnabled("./systems/pointSystem.js")&&($.registerChatCommand("./systems/pointSystem.js","makeitrain",2),$.registerChatCommand("./systems/pointSystem.js","points",7),$.registerChatSubcommand("points","add",1),$.registerChatSubcommand("points","take",1),$.registerChatSubcommand("points","set",1),$.registerChatSubcommand("points","all",1),$.registerChatSubcommand("points","setname",1),$.registerChatSubcommand("points","setgain",1),$.registerChatSubcommand("points","setofflinegain",1),$.registerChatSubcommand("points","setinterval",1),i())}),$.pointNameSingle=l,$.pointNameMultiple=m,$.getUserPoints=e,$.getPointsString=t}();
