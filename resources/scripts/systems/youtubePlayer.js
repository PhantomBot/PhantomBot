!function(){function e(e,t){var n="",s="",a=-1;if(this.found=!1,this.getVideoId=function(){return n},this.getOwner=function(){return t},this.getVideoLength=function(){if(-1!=a)return a;for(var e=$.youtube.GetVideoLength(n);0==e[0]&&0==e[1]&&0==e[2];)e=$.youtube.GetVideoLength(n);return 0==e[0]&&0==e[1]&&0==e[2]?0:(a=e[2],e[2])},this.getVideoLengthMMSS=function(){var e,t;return-1==a&&(a=this.getVideoLength()),e=(10>a/60?"0":"")+Math.floor(a/60),t=(10>a%60?"0":"")+Math.floor(a%60),e+":"+t},this.getVideoLink=function(){return"https://youtu.be/"+n},this.getVideoTitle=function(){return s},!e)throw"No Search Query Given";if(t.equals(u)||(t=t.toLowerCase()),$.inidb.exists("ytcache",e)){var i=$.inidb.get("ytcache",e),l=JSON.parse(i);n=l.id,s=l.title,a=l.time}else{var r=null;do r=$.youtube.SearchForVideo(e);while(r[0].length()<11&&"No Search Results Found"!=r[1]);if(n=r[0],s=r[1],s.equalsIgnoreCase("video marked private")||s.equalsIgnoreCase("no search results found"))throw s;this.getVideoLength();var l={};l.id=n+"",l.title=s+"",l.time=a;var i=JSON.stringify(l);$.inidb.set("ytcache",n,i)}}function t(t,n){var l=null,d=null,c=s+t,p=[],m=[],P=[],h="";return this.playlistName=t,this.loaded=!1,this.importPlaylistFile=function(t,n,a){var i=[],l=0,r=0;if($.inidb.exists("yt_playlists_registry","ytPlaylist_"+t)){if($.fileExists("./addons/youtubePlayer/"+n)){$.say($.whisperPrefix(a)+$.lang.get("ytplayer.command.importpl.file.start")),i=readFile("./addons/youtubePlayer/"+n);for(var o=0;o<i.length;o++)try{var y=new e(i[o],"importPlaylistFile");$.inidb.set(s+t,l,y.getVideoId()),l++}catch(g){$.logError("youtubePlayer.js",182,"importPlaylistFile::skipped ["+i[o]+"]: "+g),r++}return $.inidb.set(s+t,"lastkey",l),$.lang.get("ytplayer.command.importpl.file.success",l,r,n,t)}return $.lang.get("ytplayer.command.importpl.file.404",n)}return $.lang.get("ytplayer.command.importpl.file.registry404",t)},this.loadNewPlaylist=function(e){$.inidb.exists("yt_playlists_registry","ytPlaylist_"+e)&&(this.playlistName=e,c=s+e,this.loadPlaylistKeys(),connectedPlayerClient.pushPlayList())},this.getplayListDbId=function(){return c},this.getRequestFailReason=function(){return h},this.addToPlaylist=function(e,t){if(!e)return-1;var n;return t=t?t:this.playlistName,this.videoExistsInPlaylist(e,t)?-1:(t&&(n=$.inidb.exists(s+t,"lastkey")?parseInt($.inidb.get(s+t,"lastkey"))+1:0,$.inidb.set(s+t,n,e.getVideoId()),$.inidb.set(s+t,"lastkey",n)),t.equals(this.playlistName)&&(this.loadPlaylistKeys(),connectedPlayerClient.pushPlayList()),n)},this.deleteCurrentVideo=function(){var e,t=$.inidb.GetKeyList(c,"");for(e=0;e<t.length;e++)if(!t[e].equals("lastkey")&&$.inidb.get(c,t[e])==d.getVideoId()){$.inidb.del(c,t[e]);break}return this.loadPlaylistKeys()>0?(connectedPlayerClient.pushPlayList(),this.nextVideo()):connectedPlayerClient.pushPlayList(),this.getplaylistLength()},this.deleteVideoByID=function(e){var t,n=$.inidb.GetKeyList(c,"");for(t=0;t<n.length;t++)if($.inidb.get(c,n[t]).equals(e)){$.inidb.del(c,n[t]);break}this.loadPlaylistKeys(),connectedPlayerClient.pushPlayList()},this.deletePlaylist=function(e){return $.inidb.exists("yt_playlists_registry","ytPlaylist_"+e)?($.inidb.del("yt_playlists_registry","ytPlaylist_"+e),$.inidb.RemoveFile("ytPlaylist_"+e),!0):!1},this.getCurrentVideo=function(){return d},this.getPlaylistname=function(){return this.playlistName},this.getplaylistLength=function(){return p.length},this.getReadOnlyPlaylistData=function(){return m},this.getPreviousVideo=function(){return l},this.getRequestList=function(){return P},this.getRequestAtIndex=function(e){return e>P.length?null:P[e]},this.getRequestsCount=function(){return P.length},this.jumpToSong=function(t){if($.inidb.exists(c,t)){l=d;try{d=new e($.inidb.get(c,t),$.ownerName)}catch(n){return $.logError("youtubePlayer.js",233,"YoutubeVideo::exception: "+n),!1}return connectedPlayerClient.play(d),!0}return!1},this.loadPlaylistKeys=function(){var e=$.inidb.GetKeyList(c,"");p=[],m=[];for(var t=0;t<e.length;t++)e[t].equals("lastkey")||p.push(e[t]);p=a?$.arrayShuffle(p):p;for(var t=0;t<p.length;t++)m.push(p[t]);return this.loaded=!0,e.length},this.nextVideo=function(){if(!connectedPlayerClient)return null;if(l=d,P.length>0)d=P.shift();else{if(0==p.length&&0==this.loadPlaylistKeys())return null;try{var t=p.shift();d=new e($.inidb.get(c,t),u)}catch(n){$.logError("youtubePlayer.js",277,"YoutubeVideo::exception: "+n),this.nextVideo()}}return connectedPlayerClient.play(d),this.updateCurrentSongFile(d),i&&$.say($.lang.get("ytplayer.announce.nextsong",d.getVideoTitle(),d.getOwner())),d},this.preparePlaylist=function(){return $.inidb.set("ytSettings","activePlaylistname","default"),$.inidb.exists("yt_playlists_registry",c)&&$.inidb.FileExists(c)||($.setIniDbBoolean("yt_playlists_registry",c,!0),$.inidb.AddFile(c)),!0},this.removeSong=function(e){var t,n=null,s=[];for(t in P)P[t].getVideoId().equals(e)?n=P[t].getVideoTitle():s.push(P[t]);return P=s,n},this.removeUserSong=function(e){var t,n=null,s=[];for(t=P.length-1;t>=0;t--)P[t].getOwner().equals(e)&&null==n?n=P[t].getVideoTitle():s.push(P[t]);return P=s,n},this.requestSong=function(t,n){if(!$.isAdmin(n)&&(!o||this.senderReachedRequestMax(n)))return h=this.senderReachedRequestMax(n)?$.lang.get("ytplayer.requestsong.error.maxrequests"):$.lang.get("ytplayer.requestsong.error.disabled"),null;try{var s=new e(t,n)}catch(a){return h=$.lang.get("ytplayer.requestsong.error.yterror",a),$.logError("youtubePlayer.js",315,"YoutubeVideo::exception: "+a),null}if(this.videoExistsInRequests(s))return h=$.lang.get("ytplayer.requestsong.error.exists"),null;if(this.videoLengthExceedsMax(s)&&!$.isAdmin(n))return h=$.lang.get("ytplayer.requestsong.error.maxlength",s.getVideoLengthMMSS()),null;P.push(s);var i=connectedPlayerClient.checkState();return i!=playerStateEnum.UNSTARTED&&i!=playerStateEnum.ENDED||this.nextVideo(),s},this.senderReachedRequestMax=function(e){var t,n=0;e=e.toLowerCase();for(t in P)P[t].getOwner()==e&&++n;return $.bot.isModuleEnabled("./handlers/gameWispHandler.js")?n>=y+$.getTierData(e,"songrequests"):n>=y},this.updateCurrentSongFile=function(e){$.writeToFile(e.getVideoTitle(),r+"currentSong.txt",!1)},this.videoExistsInPlaylist=function(e,t){var n,a=$.inidb.GetKeyList(s+t,"");for(n in a)if(!a[n].equals("lastkey")&&$.inidb.get(s+t,a[n])==e.getVideoId())return!0;return!1},this.videoExistsInRequests=function(e){var t;for(t in P)if(P[t].getVideoId()==e.getVideoId())return!0;return!1},this.videoLengthExceedsMax=function(e){return e.getVideoLength()>g},this.playlistName?(this.preparePlaylist(),void(n&&this.loadPlaylistKeys())):this.loaded}function n(){var t=$.ytplayer,n=!1;this.pushPlayList=function(){var n,s,a={},i=[];if(currentPlaylist){for(a.playlistname=currentPlaylist.getPlaylistname()+"",a.playlist=[],i=currentPlaylist.getReadOnlyPlaylistData(),s=0;s<i.length;s++)n=new e($.inidb.get(currentPlaylist.getplayListDbId(),i[s]),$.botName),a.playlist.push({song:n.getVideoId()+"",title:n.getVideoTitle()+"",duration:n.getVideoLengthMMSS()+""});t.playList(JSON.stringify(a))}},this.pushSongList=function(){var e,n,s={},a=[];if(currentPlaylist){s.songlist=[],a=currentPlaylist.getRequestList();for(n in a)e=a[n],s.songlist.push({song:e.getVideoId()+"",title:e.getVideoTitle()+"",duration:e.getVideoLengthMMSS()+"",requester:e.getOwner()+""});t.songList(JSON.stringify(s))}},this.play=function(e){t.play(e.getVideoId(),e.getVideoTitle(),e.getVideoLengthMMSS(),e.getOwner())},this.getVolume=function(){return t.getVolume()},this.setVolume=function(e){e=parseInt(e),isNaN(e)||(t.setVolume(e),$.inidb.set("ytSettings","volume",e))},this.togglePause=function(){return t.pause(),n=!n},this.checkState=function(){return parseInt(t.getPlayerState())}}var s="ytPlaylist_",a=$.getSetIniDbBoolean("ytSettings","randomizePlaylist",!1),i=$.getSetIniDbBoolean("ytSettings","announceInChat",!1),l=$.getSetIniDbString("ytSettings","activePlaylistname","default"),r=$.getSetIniDbString("ytSettings","baseFileOutputPath","./addons/youtubePlayer/"),o=$.getSetIniDbBoolean("ytSettings","songRequestsEnabled",!0),y=$.getSetIniDbNumber("ytSettings","songRequestsMaxParallel",1),g=$.getSetIniDbNumber("ytSettings","songRequestsMaxSecondsforVideo",480),u=$.getSetIniDbString("ytSettings","playlistDJname",$.botName);playerStateEnum={NEWPAUSE:-3,NEW:-2,UNSTARTED:-1,ENDED:0,PLAYING:1,PAUSED:2,BUFFERING:3,CUED:5,KEEPALIVE:200},connectedPlayerClient=null,currentPlaylist=null,$.bind("yTPlayerDeletePlaylistByID",function(e){currentPlaylist.deleteVideoByID(e.getYouTubeID())}),$.bind("yTPlayerSongRequest",function(e){var t=currentPlaylist.requestSong(e.getSearch(),$.ownerName);null!=t&&connectedPlayerClient.pushSongList()}),$.bind("yTPlayerStealSong",function(t){var n=t.getYouTubeID()+"";n.length>1?currentPlaylist.addToPlaylist(new e(n,$.ownerName)):currentPlaylist.addToPlaylist(currentPlaylist.getCurrentVideo())}),$.bind("yTPlayerSkipSong",function(e){currentPlaylist.nextVideo(),connectedPlayerClient.pushSongList()}),$.bind("yTPlayerDeleteSR",function(e){currentPlaylist.removeSong(e.getId()),connectedPlayerClient.pushSongList()}),$.bind("yTPlayerVolume",function(e){$.inidb.set("ytSettings","volume",e.getVolume())}),$.bind("yTPlayerRequestSonglist",function(e){connectedPlayerClient.pushSongList()}),$.bind("yTPlayerRequestPlaylist",function(e){connectedPlayerClient.pushPlayList()}),$.bind("yTPlayerState",function(e){var t,n=e.getStateId();n!=playerStateEnum.NEW&&n!=playerStateEnum.NEWPAUSE||(t=$.inidb.exists("ytSettings","volume")?parseInt($.inidb.get("ytSettings","volume")):5,connectedPlayerClient.setVolume(t),currentPlaylist&&(i&&n==playerStateEnum.NEWPAUSE?(i=!1,currentPlaylist.nextVideo(),i=!0):currentPlaylist.nextVideo(),n==playerStateEnum.NEWPAUSE?connectedPlayerClient.togglePause():o&&$.say($.lang.get("ytplayer.songrequests.enabled")))),n==playerStateEnum.ENDED&&currentPlaylist&&currentPlaylist.nextVideo()}),$.bind("yTPlayerConnect",function(e){connectedPlayerClient=new n,$.consoleLn($.lang.get("ytplayer.console.client.connected")),connectedPlayerClient.pushPlayList(),$.youtubePlayerConnected=!0}),$.bind("yTPlayerDisconnect",function(e){connectedPlayerClient=null,$.consoleLn($.lang.get("ytplayer.console.client.disconnected")),o||$.say($.lang.get("ytplayer.songrequests.disabled")),$.youtubePlayerConnected=!1}),$.bind("command",function(n){var l,r,d,c=n.getCommand(),p=n.getSender().toLowerCase(),m=n.getArgs();if(c.equalsIgnoreCase("ytp")||c.equalsIgnoreCase("musicplayer")){if(l=["volume","pause"].join(", "),r=m[0],d=m.splice(1),!r)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.usage"));if(r.equalsIgnoreCase("djname")&&(d[0]?(u=d.join(" "),$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.setdjname.success",u)),$.inidb.set("ytSettings","playlistDJname",u)):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.setdjname.usage"))),r.equalsIgnoreCase("delrequest")){if(d[0]){var P=currentPlaylist.removeSong(d[0]);P?($.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.delrequest.success",d[0],P)),connectedPlayerClient.pushSongList()):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.delrequest.404",d[0]))}else $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.delrequest.usage"));return}if(r.equalsIgnoreCase("volume"))return connectedPlayerClient?void(d[0]&&!isNaN(parseInt(d[0]))?(connectedPlayerClient.setVolume(d[0]),$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.volume.set",d[0]))):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.volume.get",connectedPlayerClient.getVolume()))):void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(r.equalsIgnoreCase("pause"))return connectedPlayerClient?void connectedPlayerClient.togglePause():void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(r.equalsIgnoreCase("togglerandom")||r.equalsIgnoreCase("shuffle"))return a=!a,$.setIniDbBoolean("ytSettings","randomizePlaylist",a),currentPlaylist&&currentPlaylist.loadPlaylistKeys(),connectedPlayerClient&&connectedPlayerClient.pushPlayList(),void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.togglerandom.toggled",a?$.lang.get("common.enabled"):$.lang.get("common.disabled")));if(r.equalsIgnoreCase("toggleannounce")||r.equalsIgnoreCase("togglenotify"))return i=!i,$.setIniDbBoolean("ytSettings","announceInChat",i),void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.toggleannounce.toggled",i?$.lang.get("common.enabled"):$.lang.get("common.disabled")));if(r.equalsIgnoreCase("togglerequests")||r.equalsIgnoreCase("togglesr"))return o=!o,$.setIniDbBoolean("ytSettings","songRequestsEnabled",o),void(o?$.say($.lang.get("ytplayer.songrequests.enabled")):$.say($.lang.get("ytplayer.songrequests.disabled")));if(r.equalsIgnoreCase("setrequestmax")||r.equalsIgnoreCase("limit"))return!d[0]||isNaN(parseInt(d[0]))?void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.setrequestmax.usage")):(y=parseInt(d[0]),$.inidb.set("ytSettings","songRequestsMaxParallel",y),void $.say($.lang.get("ytplayer.command.ytp.setrequestmax.success",y)));if(r.equalsIgnoreCase("setmaxvidlength")||r.equalsIgnoreCase("maxvideolength"))return!d[0]||isNaN(parseInt(d[0]))?void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.ytp.setmaxvidlength.usage")):(g=parseInt(d[0]),$.inidb.set("ytSettings","songRequestsMaxSecondsforVideo",g),void $.say($.lang.get("ytplayer.command.ytp.setmaxvidlength.success",g)))}if(c.equalsIgnoreCase("playlist")){if(l=["add","delete","loadpl","deletepl","importpl"].join(", "),r=m[0],d=m.splice(1),!r)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.usage",l));if(r.equalsIgnoreCase("add")){if(!connectedPlayerClient)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(d.length>0){try{var h=new e(d.join(" "),p)}catch(f){return $.logError("youtubePlayer.js",641,"YoutubeVideo::exception: "+f),void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.add.failed",f))}currentPlaylist.addToPlaylist(h)?$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.add.success",h.getVideoTitle(),currentPlaylist.getPlaylistname())):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.add.failed",currentPlaylist.getRequestFailReason()))}else $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.add.usage"));return}if(r.equalsIgnoreCase("delete"))return connectedPlayerClient?void currentPlaylist.deleteCurrentVideo():void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(r.equalsIgnoreCase("loadpl")){if(!connectedPlayerClient)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(d.length>0){var b=new t(d[0],!0);0==b.getplaylistLength()?$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.load.success.new",b.getPlaylistname())):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.load.success",b.getPlaylistname())),currentPlaylist.loadNewPlaylist(d[0]),connectedPlayerClient.pushPlayList()}else $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.load.usage"));return}if(r.equalsIgnoreCase("listpl")){var x=$.inidb.GetKeyList("yt_playlists_registry","");x&&$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.listpl",x.join(", ").replace(/ytPlaylist_/g,"")))}if(r.equalsIgnoreCase("deletepl")){if(!currentPlaylist)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(d.length>0){if(d[0].equalsIgnoreCase("default"))return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.delete.isdefault"));currentPlaylist.deletePlaylist(d[0])?$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.delete.success",d[0])):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.delete.404",d[0]))}else $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.playlist.delete.usage"));return}if(r.equalsIgnoreCase("importpl")){if(3==d.length&&d[0].equalsIgnoreCase("file")){var C=new t(d[1],!1);return void $.say($.whisperPrefix(p)+C.importPlaylistFile(d[1],d[2],p))}$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.importpl.file.usage"))}}else{if(null==connectedPlayerClient)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.client.404"));if(c.equalsIgnoreCase("stealsong")&&(0==m.length?(currentPlaylist.addToPlaylist(currentPlaylist.getCurrentVideo()),$.say($.lang.get("ytplayer.command.stealsong.this.success",$.username.resolve(p)))):$.inidb.FileExists(s+m[0].toLowerCase())?(currentPlaylist.addToPlaylist(currentPlaylist.getCurrentVideo(),m[0].toLowerCase()),$.say($.lang.get("ytplayer.command.stealsong.other.success",$.username.resolve(p),m[0]))):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.playlist.404",m[0]))),(c.equalsIgnoreCase("jumptosong")||c.equalsIgnoreCase("playsong"))&&(currentPlaylist.jumpToSong(m[0])||$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.jumptosong.failed",m[0]))),c.equalsIgnoreCase("skipsong")&&(currentPlaylist.nextVideo(),connectedPlayerClient.pushSongList()),c.equalsIgnoreCase("songrequest")||c.equalsIgnoreCase("addsong")){if(0==m.length)return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.songrequest.usage"));var v=currentPlaylist.requestSong(n.getArguments(),p);null!=v?($.say($.lang.get("ytplayer.command.songrequest.success",$.resolveRank(p),v.getVideoTitle(),currentPlaylist.getRequestsCount(),v.getVideoId())),connectedPlayerClient.pushSongList()):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.songrequest.failed",currentPlaylist.getRequestFailReason()))}if(c.equalsIgnoreCase("wrongsong"))if(0==m.length){var q=currentPlaylist.removeUserSong(p);q?($.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.wrongsong.success",q)),connectedPlayerClient.pushSongList()):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.wrongsong.404"))}else if(m[0].equalsIgnoreCase("user")){if(m[1]){var q=currentPlaylist.removeUserSong(m[1].toLowerCase());q?($.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.wrongsong.user.success",m[1],q)),connectedPlayerClient.pushSongList()):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.wrongsong.404"))}}else $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.wrongsong.usage"));if(c.equalsIgnoreCase("previoussong")&&(currentPlaylist.getPreviousVideo()?$.say($.lang.get("ytplayer.command.previoussong",currentPlaylist.getPreviousVideo().getVideoTitle(),currentPlaylist.getPreviousVideo().getOwner(),currentPlaylist.getPreviousVideo().getVideoLink())):$.say($.lang.get("ytplayer.command.previoussong.404"))),c.equalsIgnoreCase("currentsong")&&$.say($.lang.get("ytplayer.command.currentsong",currentPlaylist.getCurrentVideo().getVideoTitle(),currentPlaylist.getCurrentVideo().getOwner(),currentPlaylist.getCurrentVideo().getVideoLink())),c.equalsIgnoreCase("nextsong")){var S,I;if(!m[0])return null==currentPlaylist.getRequestAtIndex(1)?void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.404")):void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.single",currentPlaylist.getRequestAtIndex(1).getVideoTitle()));if(!isNaN(m[0]))return null==currentPlaylist.getRequestAtIndex(parseInt(m[0]))?void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.404")):void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.single","#"+m[0]+": "+currentPlaylist.getRequestAtIndex(parseInt(m[0])).getVideoTitle()));if(m[0].equalsIgnoreCase("next")){if(!m[1])return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.usage"));if(isNaN(m[1]))return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.usage"));S=1,I=parseInt(m[1])}else{if(!m[0].equalsIgnoreCase("list"))return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.usage"));if(!m[1])return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.usage"));if(!m[1].match(/\d+\-\d+/))return void $.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.usage"));S=parseInt(m[1].match(/(\d+)\-\d+/)[1]),I=parseInt(m[1].match(/\d+\-(\d+)/)[1]),I-S>5&&(I=S+5)}for(var w="";I>=S&&null!=currentPlaylist.getRequestAtIndex(S);)w+="[(#"+S+") "+currentPlaylist.getRequestAtIndex(S).getVideoTitle().substr(0,20)+"] ",S++;w.equals("")?$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.range.404")):$.say($.whisperPrefix(p)+$.lang.get("ytplayer.command.nextsong.range",w))}}}),$.bind("initReady",function(){if($.bot.isModuleEnabled("./systems/youtubePlayer.js")&&($.registerChatCommand("./systems/youtubePlayer.js","ytp",1),$.registerChatCommand("./systems/youtubePlayer.js","musicplayer",1),$.registerChatCommand("./systems/youtubePlayer.js","playlist",1),$.registerChatCommand("./systems/youtubePlayer.js","stealsong",1),$.registerChatCommand("./systems/youtubePlayer.js","jumptosong",1),$.registerChatCommand("./systems/youtubePlayer.js","playsong",1),$.registerChatCommand("./systems/youtubePlayer.js","skipsong",1),$.registerChatCommand("./systems/youtubePlayer.js","songrequest"),$.registerChatCommand("./systems/youtubePlayer.js","addsong"),$.registerChatCommand("./systems/youtubePlayer.js","previoussong"),$.registerChatCommand("./systems/youtubePlayer.js","currentsong"),$.registerChatCommand("./systems/youtubePlayer.js","wrongsong"),$.registerChatCommand("./systems/youtubePlayer.js","nextsong"),$.registerChatSubcommand("wrongsong","user",2),null==currentPlaylist&&(currentPlaylist=new t(l,!0),currentPlaylist.getPlaylistname().equals("default")&&0==currentPlaylist.getplaylistLength()))){try{currentPlaylist.addToPlaylist(new e("gotxnim9h8w",$.botName))}catch(n){$.logError("youtubePlayer.js",839,"YoutubeVideo::exception: "+n)}try{currentPlaylist.addToPlaylist(new e("WFqO9DoZZjA",$.botName))}catch(n){$.logError("youtubePlayer.js",846,"YoutubeVideo::exception: "+n)}try{currentPlaylist.addToPlaylist(new e("l7C29RM1UmU",$.botName))}catch(n){$.logError("youtubePlayer.js",855,"YoutubeVideo::exception: "+n)}}})}();
